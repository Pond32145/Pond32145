name: DevOps Terminal

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

jobs:
  terminal:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install svg-term
        run: |
          sudo apt-get update
          sudo apt-get install -y nodejs npm
          sudo npm install -g svg-term-cli

      - name: Generate terminal SVG
        run: |
          cat << 'EOF' > session.txt
          pond@prod:~$ whoami
          pond_np31 (DevOps Engineer)

          pond@prod:~$ kubectl get nodes
          prod-node-1 Ready
          prod-node-2 Ready

          pond@prod:~$ docker ps
          api-service running
          web-frontend running
          postgres healthy

          pond@prod:~$ terraform plan
          No changes. Infrastructure is up-to-date.

          pond@prod:~$ uptime
          production running since 2022 ☁️
          EOF

          svg-term \
            --in session.txt \
            --out output/terminal.svg \
            --window \
            --width 80 \
            --height 24 \
            --profile dracula

      - name: Commit terminal SVG
        uses: EndBug/add-and-commit@v9
        with:
          message: "chore: update devops terminal"
